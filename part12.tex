\section{Задача о максимальном потоке}
Задача о максимальном потоке.
Теорема о минимальном разрезе и максимальном потоке.
Алгоритм Форда-Фалкерсона.
Алгоритм Эдмондса-Карпа (без доказательства корректности).
Двудольное паросочетание через потоки.

\subsection{Конспект}
Задача о максимальном потоке:
есть направленный граф, выделены две вершины $s$ и $t$,
для каждого ребра $v \to u$
назначена пропускная способность $c(v \to u) \ge 0$.
Поток через ребро --- некоторое неотрицательное значение.
Входящий поток в каждую вершину, кроме $s$ и $t$
должен быть равен исходящему,
нужно максимизировать поток в сети,
т.е.выходной поток из $s$ (он же входной поток в $t$):
\begin{eqnsystem}
    & \sum_{e = s \to u} f(e) - \sum_{e = u \to s} f(e) \to \max \\
    & \forall v \in V \setminus \{s; t\}.~\sum_{e = u \to v} f(e) = \sum_{e = v \to u} f(e) \\
    & \forall e \in E.~0 \le f(e) \le c(e) \\
\end{eqnsystem}

Поток между множествами вершин
--- сумма потоков по рёбрам,
выходящим из первого, и входящим во второе,
минус сумма из второго в первое.

\begin{theorem}
    \begin{gather*}
        f(X, X) = 0 \\
        f(X, Y) = -f(Y, X) \\
    \end{gather*}

    Если $X \cap Y = \emptyset$
    \begin{gather*}
        f(X \cup Y, Z) = f(X, Z) + f(Y, Z) \\
        f(Z, X \cup Y) = f(Z, X) + f(Z, Y)
    \end{gather*}
\end{theorem}

Разрез --- разделение вершин графа на два множества,
$V = S \cup T, S \cap T = \emptyset, s \in S, t \in T$.
Величина (вес) разреза:
\[ W = \sum_{e = u \to v, u \in S, v \in T} w(e) \]
(рёбра только в одном направлении,
т.е. разрез не симметричен).
Минимальный разрез --- разрез минимальной величины.

\begin{theorem}
    Если $f$ --- поток в сети $G$ с истоком $s$
    и стоком $t$, а $(S, T)$ --- разрез сети $G$,
    то $f(S, T) = |f|$.
\end{theorem}
\begin{proof}
    Применим предыдущую теорему многократно, получим
    \[
        f(S, T) = f(S, V) - f(S, S) = f(S, V)
        = f(s, V) + f(S \setminus s, V) = f(s, V) = |f|
    \]
\end{proof}

Следствие --- величина любого
потока не превосходит
величины любого разреза.

\begin{theorem}[О максимальном потоке и минимальном разрезе]
    Если $f$ --- поток в сети $G$,
    то следующие утверждения равносильны:
    \begin{enumerate}
        \item $f$ максимален
        \item Остаточная сеть $G_f$ не содержит дополняющих путей
        \item Для некоторого разреза $(S, T)$ выполнено
        равенство $|f| = c(S, T)$.
    \end{enumerate}
\end{theorem}
\begin{proof}
    $1 \to 2$: иначе поток не максимален

    $2 \to 3$: $S$ --- множество достижимых из $s$ в остаточной сети,
    $T$ --- остальные вершины.
    Тогда рёбер из $S$ в $T$ в остаточной сети нет

    $3 \to 1$: из $|f| = c(S, T)$ следует, что поток максимален
\end{proof}

\subsection{Форд-Фалкерсон}
Остаточные сети (графы), произвольные дополняющие пути.

Если искать дополняющий путь поиском в ширину,
то время --- $\O(VE^2)$ --- алгоритм Эдмондса-Карпа.
Каждое ребро может быть критическим $\O(V)$ раз,
т.к. длина дополняющего пути не убывает.

\subsection{Двудольное паросочетание через потоки}
Направим все рёбра из первой доли во вторую,
введём $s$ и $t$,
ограничим поток через вершины 1
(расщеплением вершины),
найдём макс. поток.
