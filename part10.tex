\section{Задача линейного программирования и симплекс-метод}
Линейное программирование.
Общий вид задачи, матричная форма и
сведение между различными представлениями.
Вершины: равносильность двух определений и достижение максимума.
Симплекс-метод, нахождение начальной точки.
Двойственность: построение двойственной
задачи, теорема о двойственности --- слабая (с доказательством)
и сильная (без доказательства) формулировки.

\subsection{Задача}
Есть набор переменных, нужно присвоить им вещественные значения
с учётом линейных ограничений
и максимизируя / минимизируя линейную функцию.

\begin{align*}
    &
    \begin{system}
        & \sum_{i=1}^n c_i x_i \to \max \\
        & \forall j \in \{1, \ldots, m\}.~\sum_{i=1}^n a_{ji} x_i \le b_j \\
        & \forall i \in \{1, \ldots, n\}.~x_i \ge 0 \\
    \end{system}
    &&
    \begin{system}
        C^T \cdot X & \to \max \\
        A \cdot X & \le B \\
        X & \ge 0 \\
    \end{system}
\end{align*}

Пример --- максимизация прибыли,
если на складе есть материалы,
из которых производятся товары
заранее известной стоимости.

Стоит обратить внимание, что неравенства нестрогие.

\subsection{Разные виды}
\begin{itemize}
    \item Целевая функция максимизируется или минимизируется
    (эквивалентно, т.к. просто $c_i$ разного знака);

    \item Ограничения неравенством или равенством:
    для $\sum_{i=1}^n a_i x_i \le b$
    вводим $s$ и пишем
    \begin{eqnsystem}
        & \sum_{i=1}^n a_i x_i + s = b \\
        & s \ge 0 \\
    \end{eqnsystem}

    Обратно --- для $A = B$ пишем $A \le B$ и $A \ge B$ ($-A \le -B$);

    \item Неограниченная переменная сводится к двум неотрицательным:
    $x = x^+ - x^-$, $x^+ \ge 0$, $x^- \ge 0$.
\end{itemize}

\paragraph{Стандартный вид:}
целевая функция минимизируется,
все переменные неотрицательные,
ограничения --- уравнения.

\subsection{Двойственная задача}
\paragraph{Пример}
\begin{eqnsystem}
    x_1 + 6 x_2 & \to \max \\
    x_1 & \le 200 \\
    x_2 & \le 300 \\
    x_1 + x_2 & \le 400 \\
    x_1, x_2 & \ge 0 \\
\end{eqnsystem}

Решение этой задачи:
$x_1 = 100, x_2 = 300$,
тогда $x_1 + 6 x_2 = 1900$.
Можно доказать, что это решение, сложив
второе и третье ограничения с коэффициентами 5 и 1:
\begin{gather*}
    5 x_2 + x_1 + x_2 \le 5 \cdot 300 + 400 \\
    x_1 + 6 x_2 \le 1900
\end{gather*}

Хотим найти такие коэффициенты для оценки в общем случае.
Обозначим коэффициенты при неравенствах
как $y_1, y_2, y_3$.
Хотим минимизировать
$y_1 \cdot x_1 + y_2 \cdot x_2 + y_3 \cdot (x_1 + x_2)$,
при этом $y_1, y_2, y_3 \ge 0$
(иначе поменяется знак неравенства).
Тогда получаем неравенство
\[
    (y_1 + y_3) x_1 + (y_2 + y_3) x_2 \le 200 y_1 + 300 y_2 + 400 y_3
\]
При этом хотим, чтобы левая часть совпала с целевой функцией,
т.е.
\[
    x_1 + 6 x_2 \le 200 y_1 + 300 y_2 + 400 y_3
\]
Для этого требуются ограничения
\begin{eqnsystem}
    y_1, y_2, y_3 & \ge 0 \\
    y_1 + y_3 & \ge 1~\text{(неравенство, т.к. $y$ только справа)} \\
    y_2 + y_3 & \ge 6
\end{eqnsystem}

Чтобы оценка была как можно более точной,
нужно минимизировать $200 y_1 + 300 y_2 + 400 y_3$.
Снова получили задачу линейного программирования:
\begin{eqnsystem}
    200 y_1 + 300 y_2 + 400 y_3 & \to \min \\
    y_1 + y_3 & \ge 1 \\
    y_2 + y_3 & \ge 6 \\
    y_1, y_2, y_3 & \ge 0 \\
\end{eqnsystem}

\paragraph{Общий случай}
Всякое решение двойственной задачи
--- оценка для прямой задачи,
поэтому пара решений с совпадающими
значениями будет оптимальной.

Если прямая задача:
\begin{eqnsystem}
    & \sum_{i=1}^n c_i x_i \to \max \\
    & \forall j \in \{1, \ldots, m\}.~\sum_{i=1}^n a_{ji} x_i \le b_j \\
    & \forall i \in \{1, \ldots, n\}.~x_i \ge 0 \\
\end{eqnsystem}

То двойственная --- это оценка для прямой, и будет иметь вид:
\begin{eqnsystem}
    & \sum_{j=1}^m b_i y_i \to \min \\
    & \forall i \in \{1, \ldots, n\}.~\sum_{j=1}^m a_{ji} y_j \ge c_i \\
    & \forall j \in \{1, \ldots, m\}.~y_j \ge 0 \\
\end{eqnsystem}

Матричный вид:
\begin{align*}
    &
    \begin{system}
        C^T \cdot X & \to \max \\
        A \cdot X & \le B \\
        X & \ge 0 \\
    \end{system}
    &&
    \begin{system}
        B^T \cdot Y & \to \min \\
        A^T \cdot Y & \ge C \\
        Y & \ge 0
    \end{system}
\end{align*}

Из матричного вида очевидно,
что двойственная задача к двойственной задаче
--- прямая задача.

\begin{theorem}[Теорема о двойственности]
    Если линейная программа имеет ограниченный
    оптимум, то двойственная программа также
    имеет ограниченный оптимум,
    и они равны.
\end{theorem}

\begin{theorem}[Слабая теорема о двойственности]
    Разница между прямым и двойственным оптимумом
    неотрицательна.
\end{theorem}
\begin{proof}
    \[
        C^T X = X^T C \le X^T A^T Y \le B^T Y
    \]
\end{proof}

\subsection{Симплекс-метод}
Линейные ограничения задают гиперплоскости,
которые содержат грани полиэдра (многогранника),
в котором лежат все точки, попадающие под ограничения.
Ограничения могут быть не замкнуты,
тогда функция может быть бесконечной,
либо точек, попадающих под ограничения,
может не быть.
Если же ограничения замкнуты,
тогда ответ лежит в одной из вершин.

Симплекс-метод:
найти некоторую вершину,
дальше идти в сторону тех соседей,
для которых целевая функция увеличивается.

\begin{definition}
    Вершина в $n$-мерном пространстве
    --- единственная точка пересечения $n$ гиперплоскостей
    (или единственное решение системы из $n$ линейных уравнений).
\end{definition}
\begin{definition}
    Две вершины в $n$-мерном пространстве называются \emph{соседними},
    если у них $(n - 1)$ одинаковое уравнение.
\end{definition}

Если находимся в начале координат,
то у всех соседних вершин все координаты,
кроме одной, нулевые.

Если не находимся в начале координат,
то можно совершить афинное преобразование пространства,
чтобы нормали к плоскостям,
на пересечении которых мы находимся,
задавали новое пространство.
Была целевая функция
$\alpha + C^T X$, стала $c_u + \tilde{C}^T Y$,
где $c_u$ --- значение в вершине $u$.

Тогда глобальный оптимум получается,
когда все преобразованные $\tilde{c}_i \le 0$.

\subsubsection{Как найти начальную вершину}
Ноль не всегда попадает под ограничения.
Пусть есть задача в стандартном виде:
\begin{align*}
    & c^T x \to \min
    && Ax = b
    && x \ge 0
\end{align*}
Считаем, что $b \ge 0$.
Запишем новую линейную программу:
на каждое уравнение введём $z \ge 0$:
$z + Ax = z + b$.
Минимизировать будем
$z_1 + z_2 + \ldots + z_m$.

У такой задачи легко получить
вершину: $z = b, x = 0$.

Если в оптимуме сумма $z$ оказалась нулём,
то все $z_j$ --- нули, следовательно,
найденные $x_i$ подходят под ограничения исходной задачи.

Если же наименьшая сумма больше нуля,
то исходная задача несовместна.

\subsubsection{Неограниченная задача}
На каком-то шаге возникнет
бесконечно удалённая соседняя вершина.
Тогда она будет доказательством,
что оптимум бесконечен.

\subsubsection{Время работы}
$\O(mn)$ за итерацию,
где $m$ --- количество ограничений,
а $n$ --- количество переменных,
потому что на каждом шаге у нас
преобразуется система координат.

Но количество итераций
--- до количества вершин,
т.е. $\binom{m + n}{n}$.
Т.е. симплекс-метод экспоненциален.
