\section{Методы решения NP-полных задач}
Методы решения NP-полных задач.
Backtracking, Branch \& Bound, параметризованные алгоритмы.
Приближенные алгоритмы для NP-полных задач.
2-приближенный алгоритм для вершинного покрытия.
2-приближенный алгоритм для метрического коммивояжёра.
Алгоритм Кристофидеса-Сердюкова.
Константное приближение TSP влечёт P = NP.
$\log(n)$-приближенный алгоритм для покрытия множествами.
Формулировка жадной гипотезы о надстроке.

\subsection{Конспект}
TSP --- задача коммивояжёра:
существует ли простой цикл,
проходящий через все вершины.

\bigskip

2-приближённый вершинного покрытия
--- смотрим на каждое ребро, если оно уже покрывается,
то всё ок, если нет, то берём обе его вершины.

\bigskip

Метрическая TSP: на входе полный граф,
веса между вершинами --- расстояния (математические).
Тогда 2-приближением будет построить MST,
провести обход по нему в порядке DFS,
и удалить повторения вершин из пути.
Истинный кратчайший путь $S$
как минимум содержит в себе какое-то
остовное дерево, следовательно,
не меньше MST.
А путь, который мы нашли, это удвоенное MST.

\bigskip

Алгоритм Кристофидеса-Сердюкова:
в $T$ количество вершин нечётной степени чётно.
Найдём совершенное паросочетание
минимального веса (не умеем это делать) $M$
на этих вершинах
и добавим его рёбра в $T$,
получился мультиграф с вершинами чётной степени.
Теперь существует эйлеров цикл,
возьмём его и удалим повторы.

$2 |M| \le |S|$:
построим два паросочетания $M_1$ и $M_2$ на вершинах $M$,
идя по $S$ и чередуя рёбра (т.е. $M_1 \cup M_2 \subset S$).
Тогда $|M_1| + |M_2| \le |S|$,
а $|M| \le \min(|M_1|, |M_2|)$.
Следовательно, это будет $3/2$-приближением.

\begin{theorem}
    Если существует константное приближение
    произвольной задачи коммивояжёра
    (т.е. не обязательно метрическое)
    с путём вместо цикла,
    то P = NP.
\end{theorem}
\begin{proof}
    Сведём поиск гамильтонова пути к задаче коммивояжёра.
    Из заданного графа $G$ построим полный граф $H$
    следующим образом:
    \[
        w(u \to v) =
        \begin{cases}
            1 & u \to v \in E \\
            \alpha \cdot n & u \to v \notin E \\
        \end{cases}
    \]

    Пусть $\mathcal{A}(H)$ --- $\alpha$-приближение $TSP(H)$.

    Тогда если гамильтонов путь существует, то
    \begin{align*}
        TSP(H) & = n - 1 \\
        \mathcal{A}(H) & \le \alpha \cdot (n - 1) \\
    \end{align*}

    В противном случае
    \begin{align*}
        TSP(H) & \ge \alpha n \\
        \mathcal{A}(H) & \ge \alpha n > \alpha \cdot (n - 1) \\
    \end{align*}

    Таким образом, существование $\alpha > 0$-сведения
    задачи коммивояжёра о пути на полном графе
    позволяет за полином решить NP-полную задачу
    о гамильтоновом пути.
\end{proof}

(более очевидно, если будем доказывать через гамильтонов цикл)

\subsection{Покрытие множествами}
Есть множество $U$ элементов,
нужно найти такой минимальный набор из заданных подмножеств $S_i$,
что всё множество будет покрыто.

Жадно берём наибольшее множество $S_j$ из заданных подмножеств,
затем из всех имеющихся множеств удаляем покрытые им элементы:
\begin{algorithmic}
    \State $U \gets U \setminus S_j$
    \State $S_i \gets S_i \setminus S_j$
\end{algorithmic}

\begin{theorem}
    Если истиный размер покрытия --- $k$,
    то размер найденного покрытия не больше $k \ln n$.
\end{theorem}
\begin{proof}
    Пусть $U_t$ --- оставшиеся непокрытыми элементы после $t$-го шага,
    $|U_t| = n_t, U_0 = U$.
    Тогда на каждой итерации существует покрытие
    $U_t$ $k$ оставшимися множествами, следовательно,
    $\exists i.~|S_i \cap U_t| \ge n_t / k$.
    Тогда
    \[
        n_t
        \le n_{t - 1} \cdot \parens{1 - \frac{1}{k}}
        \le \ldots
        \le n \cdot \parens{1 - \frac{1}{k}}^t
        = n \cdot \parens{1 - \frac{1}{k}}^{k \cdot \frac{t}{k}}
        < n \cdot \exp \parens{-\frac{t}{k}}
    \]

    Как только $n_t < 1$, получили покрытие.
    \begin{align*}
        n_t & < n \cdot \exp \parens{-\frac{t}{k}} < 1 \\
        & \Rightarrow n < \exp \parens{\frac{t}{k}} \\
        & \Rightarrow \ln n < \frac{t}{k} \\
        & \Rightarrow t > k \ln n
    \end{align*}
    То есть если сделали $\ceil{k \ln n}$ шагов,
    то все элементы покрыты.
    Размер ответа --- $\ceil{k \ln n}$.
\end{proof}

\subsection{Жадная гипотеза о надстройке}
Есть словарь $S_i$, нужно найти минимальную строку $S$,
что все строки из словаря --- её подстроки.
Гипотеза: жадный алгоритм даёт 2-приближение.

Жадный алгоритм: на каждом шаге берём две строки
с максимальным наложением и заменяем их на их склейку в словаре.

Лучший известный алгоритм с доказанной оценкой
даёт $2\frac{11}{23}$-приближение.
